import{j as e}from"./jsx-runtime.D5qyYPMi.js";import{r as u}from"./index.CZlPm10g.js";import{B as m}from"./Button.T5o0TRFc.js";import{F as f,a as b}from"./formik.esm.C2D3lyQ3.js";import{I as i}from"./Input.BieRLi0Z.js";import{A as c,a as l}from"./index.D0FmFtl_.js";import{u as t}from"./userStore.C_79YqMW.js";import{B as n}from"./_astro-entry_react-toastify.CX4FvO7v.js";import"./iconBase.Dh1Tc97b.js";const j=s=>{const a={};return s.oldPassword||(a.oldPassword="La antigua contraseña es requerida"),s.newPassword||(a.newPassword="La nueva contraseña es requerida"),s.newPassword===s.oldPassword&&(a.newPassword="La nueva contraseña no puede ser la misma que la antigua"),s.newPassword.length<8&&(a.newPassword="La contraseña debe tener al menos 8 caracteres"),s.newPassword.length>15&&(a.newPassword="La contraseña no puede tener más de 15 caracteres"),/(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])/.test(s.newPassword)||(a.newPassword="La contraseña debe tener una letra mayúscula, una letra minúscula, un número y un carácter especial"),s.confirmNewPassword||(a.confirmNewPassword="Por favor confirme su contraseña"),s.newPassword!==s.confirmNewPassword&&(a.confirmNewPassword="Las contraseñas no coinciden"),a},k=()=>{const[s,a]=u.useState(!0),x=t(r=>r.user),w=t(r=>r.changePassword),h=t(r=>r.removeSession),o=()=>{a(!s)};return e.jsxs("section",{className:"w-full text-center my-4 bg-white px-12 py-16 rounded-l-lg flex flex-col max-w-[80%] gap-2",children:[e.jsx("h1",{className:"font-bold text-4xl text-primary",children:"Seguridad"}),e.jsxs("div",{className:"p-4  flex flex-col  items-center rounded-lg max-h-96 overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl  text-primary font-bold mb-4",children:"Configuración de Seguridad"}),e.jsxs("div",{className:"mb-6 w-80 flex flex-col justify-center items-center ",children:[e.jsx("h3",{className:"text-xl text-primary font-semibold mb-2",children:"Cambio de Contraseña"}),e.jsx(f,{initialValues:{oldPassword:"",newPassword:"",confirmNewPassword:""},validate:j,onSubmit:(r,{resetForm:N})=>{const{confirmNewPassword:P,...p}=r;w(p,x.id).then(d=>{n.success("El Cambio de contraseña se realizo con exito"),h(),n.info("Se va a cerrar sesión, vuelve a loguearte con la nueva contraseña"),setTimeout(()=>{window.location.href="/auth/login"},3e3)}).catch(d=>{console.log(d),n.error("Las credenciales estan mal")})},children:({errors:r})=>e.jsxs(b,{className:" flex flex-col justify-center items-center ",children:[e.jsxs("div",{className:"relative",children:[e.jsx(i,{error:r.oldPassword,label:"Contraseña Actual",name:"oldPassword",placeholder:"**********",type:"password"}),e.jsx("div",{onClick:o,className:"absolute right-0 top-2/3  transform  cursor-pointer",children:s?e.jsx(l,{color:"red"}):e.jsx(c,{color:"red"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(i,{error:r.newPassword,label:"Nueva contraseña",name:"newPassword",placeholder:"**********",type:s?"password":"text"}),e.jsx("div",{onClick:o,className:"absolute right-0 top-2/3  transform  cursor-pointer",children:s?e.jsx(l,{color:"red"}):e.jsx(c,{color:"red"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(i,{error:r.confirmNewPassword,label:"Confirmar contraseña",name:"confirmNewPassword",placeholder:"**********",type:"password"}),e.jsx("div",{onClick:o,className:"absolute right-0 top-2/3  transform  cursor-pointer",children:s?e.jsx(l,{color:"red"}):e.jsx(c,{color:"red"})})]}),e.jsx(m,{className:"mt-4 p-0.5 text-base w-fit",type:"submit",children:"Hacer Cambio"})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl text-primary font-semibold mb-2",children:"Historial de Inicios de Sesión"}),e.jsxs("ul",{className:"bg-gray-100 p-4 rounded-lg",children:[e.jsx("li",{className:"mb-2",children:"Fecha: 2024-06-27, IP: 192.168.1.1, Ubicación: Madrid, España"}),e.jsx("li",{className:"mb-2",children:"Fecha: 2024-06-25, IP: 192.168.1.2, Ubicación: Barcelona, España"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl  text-primary font-semibold mb-2",children:"Sesiones Activas"}),e.jsxs("ul",{className:"bg-gray-100 p-4 rounded-lg",children:[e.jsx("li",{className:"mb-2",children:"Dispositivo: MacBook Pro, Navegador: Chrome, Último acceso: 2024-06-27"}),e.jsx("li",{className:"mb-2",children:"Dispositivo: iPhone, Navegador: Safari, Último acceso: 2024-06-25"})]}),e.jsx(m,{className:" text-white ",children:"Cerrar sesión en todos los dispositivos"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl text-primary  font-semibold mb-2",children:"Aplicaciones Conectadas"}),e.jsxs("ul",{className:"bg-gray-100 p-4 rounded-lg",children:[e.jsxs("li",{className:"mb-2",children:["Aplicación: Google, Último acceso: 2024-06-27"," ",e.jsx("button",{className:"text-red-500 ml-2",children:"Revocar Acceso"})]}),e.jsxs("li",{className:"mb-2",children:["Aplicación: Facebook, Último acceso: 2024-06-25"," ",e.jsx("button",{className:"text-red-500 ml-2",children:"Revocar Acceso"})]})]})]})]})]})};export{k as default};
